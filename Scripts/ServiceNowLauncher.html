<!doctype html><html><head>
<script>

//customization variables; you can edit these to fit the business requirements
const serviceNowPrefix='myco';
const assetTagFormatRegex = 'XYZ[0-9]{5}';

</script>
<style>
body { padding-top: 20px; padding-left: 10px; } 
textarea, button, input { margin-right: 15px; margin-bottom: 15px; } 
button { height: 100px; width: 250px; vertical-align: text-top;  }
</style>
</head><body>
<table>
	<tr>
	<table style="float:left;">
		<tr><td><input    id="myInput1"  rows=35 tabindex=2 onkeypress="inputKeyPressed(event)"></input></td></tr>
		<tr><td><textarea id="myListTA1" rows=35 tabindex=1 columns=20>XYZ1749001	C001888854</textarea></td></tr>
	</table>
	<td width=1>
	<button onclick="openTabs()" tabIndex=3>Open&nbsp;Individual&nbsp;Tab(s)</button>
	</td><td>
	<button onclick="openList()">Open&nbsp;Bookmarkable&nbsp;List</button>
	</td>
	</tr>
</table>
<p>
To use this file, it needs to be downloaded to your hard drive with the javascript code intact.  Create a shortcut to it (bookmark or use instructions below for a taskbar shortcut).  For multiple items, in the larger text area, paste, type, or scan in multiple asset tags, Dell service tags/serial numbers, SCTASK, REQ, RITM, or INC numbers and use one of the buttons.  The entries can be separated by newlines, spaces, tabs, or commas, doesn't matter.
</p><p>
You can create a taskbar shortcut to this file by doing something like this; download/unzip this html file and then create a Windows shortcut with a path like this to the unzipped/downloaded location on your hard drive: <br>
<pre>"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" "file:///C:/Users/b/eclipse/w1/Scripts/ServiceNowLauncher.html"</pre>
You can then give the shortcut a different icon if you like (I use the tree icon from c:\windows\system32\shell32.dll), and then right-click on the shortcut and "Pin to Taskbar".
</p>
<script>  //core logic....
const urlParams = new URLSearchParams(window.location.search);
var operationMode=urlParams.get('mode');
class ServiceNowType {
		constructor(p_regex, p_actionName, p_criteriaColumn) {
			this.regex = new RegExp(p_regex); this.actionName = p_actionName; this.criteriaColumn = p_criteriaColumn;
		}
}
const alm_hardwareType = 
    new ServiceNowType(assetTagFormatRegex,'alm_hardware',                     'asset_tag'); 
const ServiceNowTypes = new Array(
	new ServiceNowType(assetTagFormatRegex,'alm_hardware',                     'asset_tag'),
	new ServiceNowType('SCTASK[0-9]{7}'   ,'sc_task'     ,                     'number'   ),
	new ServiceNowType(   'INC[0-9]{7}'   ,'incident'    ,                     'number'   ),
	new ServiceNowType(  'RITM[0-9]{7}'   ,'sc_task'     ,        'request_item.number'   ),
	new ServiceNowType(   'REQ[0-9]{7}'   ,'sc_task'     ,'request_item.request.number'   ),
	);
function openList() {
	taValues = fancySplit(myListTA1.value.toUpperCase());
	snType = getApplicableServiceNowType(taValues[0])
	var valuesURLEscaped = ''
	for(var i = 0; i < taValues.length; i++) {
		valuesURLEscaped += ('%2C'+taValues[i])
	}
	window.open('https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'_list.do?sysparm_query='+snType.criteriaColumn+'IN'+valuesURLEscaped, '_blank')
}
function inputKeyPressed(event) {
	if(event.key === "Enter" || event.key === " ") {
		openTab(alm_hardwareType, myInput1.value);
	}
}
function openTabs() {
	taValues = fancySplit(myListTA1.value.toUpperCase());
	snType = getApplicableServiceNowType(taValues[0])
	console.log('taValues: ' + taValues);
	for(var i = 0; i < taValues.length; i++) {
		openTab(snType, taValues[i]);
	}
}
function openTab(snType, value) {
	var url='https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'.do?sysparm_query='+snType.criteriaColumn+'%3D'+value
	window.open(url, '_blank')
}
function getApplicableServiceNowType(representativeValue) {
	const matches = [];
	for(var i=0; i<ServiceNowTypes.length;i++) {
		if(ServiceNowTypes[i].regex.test(representativeValue)) {
			matches.push(ServiceNowTypes[i])
		}
	}
	return matches[0]; //TODO more elegantly handle cases where there are 0 or >1 matches rather than blindly taking the first match and assuming there is at least one match...
}
function fancySplit(inString) {	return inString.replaceAll(/( |;|\r|\n|	|,|%20){1,}/g,' ').trim().split( ' ' ); }
function delimit(inArray, delimiter) {
	var result = ''; for(var i = 0; i < inArray.length; i++) { if(i > 0) { result += delimiter; } result += inArray[i];	}
	return result; // this function is pretty basic stuff so I put on one line to save space; if you want to see individual lines just auto-format it.
}

if (operationMode == 'multiple') {
	document.getElementById("myListTA1").focus()
} else {
	document.getElementById("myInput1").focus()
}

</script></body></html>