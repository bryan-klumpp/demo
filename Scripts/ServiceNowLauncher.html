<!doctype html><html><head>
<script>

//customization variables; you can edit these to fit the business requirements
const serviceNowPrefix='myco';
const assetTagFormatRegex = 'XYZ[0-9]{5}';

</script>
<style>
  button { margin-top: 10px; margin-left: 10px; margin-right: 10px            }
</style>
</head><body>
<table>
<tr> 
<div style="float:left; ">
<textarea id="myListTA1" rows=35 columns=20>XYZ82238  	
asdf, ,
XYZ55555;
f

</textarea>
<td width=1>
<div style="vertical-align: text-top; "; >
<button onclick="lookupList()">Lookup&nbsp;List</button>
</div>
</div>
</td>
</tr>
</table>

<script>  //core logic....

class ServiceNowType {
		constructor(p_regex, p_actionName, p_criteriaColumn) {
			this.regex = new RegExp(p_regex); this.actionName = p_actionName; this.criteriaColumn = p_criteriaColumn;
		}
}
const ServiceNowTypes = new Array(
	new ServiceNowType(assetTagFormatRegex,'alm_hardware',             'number'), 
	new ServiceNowType('SCTASK[0-9]{7}'   ,'sc_task'     ,             'number'),
	new ServiceNowType(   'INC[0-9]{7}'   ,'incident'    ,             'number'),
	new ServiceNowType(  'RITM[0-9]{7}'   ,'sc_task'     ,'request_item.number'),
	);

function lookupList() {
	taValues = fancySplit(myListTA1.value);
	snType = getApplicableServiceNowType(taValues[0])
	var valuesURLEscaped = ''
	for(var i = 0; i < taValues.length; i++) {
		valuesURLEscaped += ('%2C'+taValues[i])
	}
	window.open('https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'_list.do?sysparm_query='+snType.criteriaColumn+'IN'+valuesURLEscaped, '_blank')
}

function getApplicableServiceNowType(representativeValue) {
	const matches = [];
	for(var i=0; i<ServiceNowTypes.length;i++) {
		if(ServiceNowTypes[i].regex.test(representativeValue)) {
			matches.push(ServiceNowTypes[i])
		}
	}
	return matches[0]; //TODO more elegantly handle cases where there are 0 or >1 matches rather than blindly taking the first match and assuming there is at least one match...
}
function fancySplit(inString) {
	const myRegex = /( |;|\r|\n|	|,|%20){1,}/g
	return inString.replaceAll(myRegex,' ').trim().split( ' ' );
}
function delimit(inArray, delimiter) {
	var result = '';
	for(var i = 0; i < inArray.length; i++) {
		if(i > 0) {
			result += delimiter;
		}
		result += inArray[i];
	}
	return result;
}
</script>

</body>


</html>