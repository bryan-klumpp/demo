<!doctype html><html><head>
<script>

//customization variables; you can edit these to fit the business requirements
const serviceNowPrefix='myco';
const assetTagFormatRegex = 'XYZ[0-9]{7}';

</script>
<style>
body { padding-top: 20px; padding-left: 10px; } 
textarea, button, input { margin-right: 15px; margin-bottom: 15px; } 
button { height: 100px; width: 250px; vertical-align: text-top;  }
</style>
</head><body>
<table>
	<tr>
	<table style="float:left;">
		<tr><td>Single asset tag;<br>Press Enter or Spacebar<br>to execute.</td></tr>
		<tr><td><input    id="singleAssetTagInputBox"  columns=15 tabindex=2 onkeypress="assetTagInputBoxKeyPressed(event)" value=XYZ1888854></input></td></tr>
		<tr><td>Mutiple items list,<br>various formats;<br>Use buttons to execute.</td></tr>
		<tr><td><textarea id="myListTA1" rows=35 tabindex=1 columns=15>x</textarea></td></tr>
	</table>
	<td width=1>
	<button onclick="openMultipleTabs()" tabIndex=3>Open&nbsp;Individual&nbsp;Tab(s)</button>
	</td><td>
	<button onclick="openList()">Open&nbsp;Bookmarkable&nbsp;List</button>
	</td>
	</tr>
</table>
<p>
To use this file, it needs to be downloaded to your hard drive with the javascript code intact.  Create a shortcut to it (bookmark or use instructions below for taskbar shortcuts).  For multiple items, in the larger text area, paste, type, or scan in multiple asset tags, Dell service tags/serial numbers, SCTASK, REQ, RITM, or INC numbers and use one of the buttons.  The entries can be separated by newlines, spaces, tabs, or commas.
</p><p>
You can create a taskbar shortcut to this file by doing something like this; download/unzip this html file and then create a new Windows shortcut with a path like the one below, noting the unzipped/downloaded location of the html file on your hard drive: <br>
<pre>"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" "file:///C:/Users/b/eclipse/w1/Scripts/ServiceNowLauncher.html?mode=single"</pre>
You can then give the shortcut a different icon if you like (I use the star icon from c:\windows\system32\shell32.dll), and then right-click on the shortcut and "Pin to Taskbar".  Also you can create a separate shortcut and change the URL parameter to mode=multiple (which will highlight the larger text area by default) and create a separate taskbar icon (I like the tree icon from the aforementioned dll).
</p>
<script>  //core logic....
const urlParams = new URLSearchParams(window.location.search);
var operationMode = urlParams.get('mode');
//const singleAssetTagInputBox = document.getElementById("singleAssetTagInputBox") //not sure if this is needed
class ServiceNowType {
		constructor(p_regex, p_actionName, p_criteriaColumn) {
			this.regex = new RegExp('^'+p_regex+'$'); this.actionName = p_actionName; this.criteriaColumn = p_criteriaColumn;
		}
}
const alm_hardwareTypeByAssetTag = 
    new ServiceNowType(assetTagFormatRegex,'alm_hardware',                     'asset_tag'); 
const ServiceNowTypes = new Array(
	new ServiceNowType('SCTASK[0-9]{7}'   ,'sc_task'     ,                     'number'   ),
	new ServiceNowType(   'INC[0-9]{7}'   ,'incident'    ,                     'number'   ),
	new ServiceNowType(  'RITM[0-9]{7}'   ,'sc_task'     ,        'request_item.number'   ),
	new ServiceNowType(   'REQ[0-9]{7}'   ,'sc_task'     ,'request_item.request.number'   ),
	alm_hardwareTypeByAssetTag,
	new ServiceNowType('[A-Za-z0-9]{7}' ,'alm_hardware',              'serial_number'   )
	);
function openList() {
	taValues = fancySplit(myListTA1.value.toUpperCase());
	snType = getApplicableServiceNowType(taValues[0])
	var valuesURLEscaped = ''
	for(var i = 0; i < taValues.length; i++) {
		valuesURLEscaped += ('%2C'+taValues[i])
	}
	window.open('https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'_list.do?sysparm_query='+snType.criteriaColumn+'IN'+valuesURLEscaped, '_blank')
}
function assetTagInputBoxKeyPressed(event) {
	if(event.key === "Enter" || event.key === " ") {
		openTab(alm_hardwareTypeByAssetTag, singleAssetTagInputBox.value);
	}
}
async function openMultipleTabs() {
	if (myListTA1.value == "") { //most likely the user incorrectly used the single input box, we'll try helping them out and move the value to the multiple-entry text box to show the user which box should go with the multi-tab button
		myListTA1.value = singleAssetTagInputBox.value
		singleAssetTagInputBox.value = ""
		await new Promise(r => setTimeout(r, 1000)); //wait a bit to let the user see the value moved to the correct box
	}
	taValues = fancySplit(myListTA1.value.toUpperCase());
	snType = getApplicableServiceNowType(taValues[0])
	console.log('taValues: ' + taValues);
	for(var i = 0; i < taValues.length; i++) {
		openTab(snType, taValues[i]);
	}
}
function openTab(snType, value) {
	var url='https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'.do?sysparm_query='+snType.criteriaColumn+'%3D'+value
	window.open(url, '_blank')
}
function getApplicableServiceNowType(representativeValue) {
	const matches = [];
	for(var i=0; i<ServiceNowTypes.length;i++) {
		if(ServiceNowTypes[i].regex.test(representativeValue)) {
			matches.push(ServiceNowTypes[i])
		}
	}
	if(matches.length == 0) {
		alert('Unable to determine a proper handler for the representative input data: <<<'+representativeValue+
		   '>>>\n\nValid formats (regular expression syntax) are:\n'+
		   ServiceNowTypes.map(snType => snType.regex).toString().replaceAll(/[?^/$,]+/g,'\n'))
	}
	return matches[0]; //For now we're just taking the first match; if there are multiple matching formats the rest will be ignored, which places a bit of importance on the ordering of the formats in the ServiceNowTypes array.  I could have just used a non-array variable here, but having an array may help with debugging.
}
function fancySplit(inString) {	
	/* this cleans up and divides the multiple input values by using a regular expression
	   to convert all non-signficant characters down to a single comma 
	   between the significant characters, then splitting them by that comma.*/ 
	return inString.replaceAll(/( |;|\r|\n|	|,|%20){1,}/g,',').trim().split( ',' ); 
}
function delimit(inArray, delimiter) {
	var result = ''; for(var i = 0; i < inArray.length; i++) { if(i > 0) { result += delimiter; } result += inArray[i];	}
	return result; // this function is pretty basic stuff so I put on one line to save space; if you want to see individual lines just auto-format it.
}

if (operationMode == 'multiple') {
	document.getElementById("myListTA1").focus()
} else {
	singleAssetTagInputBox.focus()
}

</script></body></html>