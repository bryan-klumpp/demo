<!doctype html><html><head>
<script>

//customization variables; you can edit these to fit the business requirements
const serviceNowPrefix='myco';
const assetTagFormatRegex = 'XYZ[0-9]{5}';

</script>
<style></style>
</head><body>
<table>
<tr><textarea id="myListTA1" rows=20 columns=20>XYZ82238  	
asdf, ,
XYZ55555;
f

</textarea></tr>
</table>

<button onclick="lookupList()">Lookup List</button>
<button onclick="testFancySplit()">Self Test</button>

<script>  //core logic....

class ServiceNowType {
		constructor(p_regex, p_actionName) {
			this.regex = new RegExp(p_regex); this.actionName = p_actionName;
		}
}
const ServiceNowTypes = new Array(new ServiceNowType(assetTagFormatRegex,'alm_hardware'), new ServiceNowType(assetTagFormatRegex,'sc_task'));

function lookupList() {
	taValues = myListTA1.value.split('\n');
	snType = getApplicableServiceNowType(taValues[0])
	var valuesURLEscaped = ''
	for(var i = 0; i < taValues.length; i++) {
		valuesURLEscaped += ('%2C'+taValues[i])
	}
	window.open('https://'+serviceNowPrefix+'.service-now.com/'+snType.actionName+'_list.do?sysparm_query=numberIN'+valuesURLEscaped, '_blank')
}

function getApplicableServiceNowType(representativeValue) {
	const matches = [];
	for(var i=0; i<ServiceNowTypes.length;i++) {
		if(ServiceNowTypes[i].regex.test(representativeValue)) {
			matches.push(ServiceNowTypes[i])
		}
	}
	return matches[0]; //TODO more elegantly handle cases where there are 0 or >1 matches rather than blindly taking the first match and assuming there is at least one match...
}

function testFancySplit() {
	const inString = "XYZ82238  	,;\r\nABC55555 %20 theend ";
	result = fancySplit(inString);
	const expectedResult = "XYZ82238,ABC55555,theend";
	alert(fancySplit(inString));
}

function fancySplit(inString) {
	const aReallyGreatRegexDONTCHANGETHIS = /( |;|\r|\n|	|,|%20){1,}/g
	const myRegex = /( |;|\r|\n|	|,|%20){1,}/g
	return inString.replaceAll(myRegex,' ').trim().split( ' ' );
}
function delimit(inArray, delimiter) {
	var result = '';
	for(var i = 0; i < inArray.length; i++) {
		if(i > 0) {
			result += delimiter;
		}
		result += inArray[i];
	}
	return result;
}

lookupList();
</script>

</body>


</html>